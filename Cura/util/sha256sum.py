"""
Helper module to check sha256 sum.
"""
__copyright__ = "Copyright (C) 2019 Dagoma - Released under terms of the AGPLv3 License"


import hashlib

hash_sums = [
	'9aa9d7688b95031983d26188aad9efbc26e81e8abb12ef23241bd34891a01a6a',
	'bc39f0cf55f04d41fe66a75e74621bfdd0b245763de819d53c3925dd4bb49e9e',
	'db556d48550225fba9bd4d3f5f705a1e028569ab086801eaf2e669b6a6f11a69',
	'bd189c604c1245b693bb4e528b7dd467043606cd3760b549ca6b2f6f5168e6d8',
	'f06320f1e72adddcbf806ed85284ec65e65ae97446826e0d35e010edf8d73169',
	'294fe3f79a64fc1a6f644eb45ffb8e3ceb05df93f08e238378aa5b5969ae6446',
	'40bd5d90f636664931ef14c5c1c0a28c4b24e67d9db78c2e2df01b804ae70f39',
	'81b89e83ff90858eb873a8f80a34c66284d7d39dd3a033124c384c5cfee3a63a',
	'ac7e7ae44e054657cd59cc4653c5d5965110e3acf3f44bfe119096704e2a5e12',
	'b3166adc4fb6c001bc80b8f5c3198efc0133f9c8ecf71773dafae9203047e4e4',
	'c02adc8d9ed2d98314497a4efbf2ad3478e34a9aac5ae71cacb8e08e9d050b59',
	'6dbc4801d692477e0c09fb6cd0722016b5686e63fedde49f5bc48933ae91176f',
	'1dbcadde205965c3c0055d2291cb65f4c86b9372424015e4619950eb7a258df6',
	'befcff66a2bedf094e0e8897730d87d8645d666f75fd6a6cf63bb55bd19390c8',
	'2f02b2bc5d3b55efbcad7afeb3c43df15535c37b76c65e29e3d10eb1c449da91',
	'4e2542a350355048089bb483efb9224d73b558d5502f1885edf5c849741d59ad',
	'e6ee9a9ff1f830d3e895d0f18c920bd5520bcf5a5cceade46f660e8895595dc3',
	'3705786b77a47470b4b4045239db9333dfec75235e41ebb2868b75e5d447267d',
	'4a24bc31fb8eeb9a422643e769c3e10a80f1895c5144c255b6e60a3eb91d1a29',
	'a08c107b887acdbfd090c6c13a3747d9c71a5a779f570ccf8f6484b65e6ec929',
	'ca852267f9df8188de346c243f14954a06caaf06dba401be040fe96601b86618',
	'8676737038400375370adabfa618997213f4dd45b528cc7b60d7241b5a946c51',
	'61989f5b1cf2d3d537e04dc71d77711771e6da4e3d4959c01eff5f002b2d51cb',
	'5916c2dc7f0c5de2e626989809bd6a1054f12e8a73166b1d41be67f4809bf151',
	'be6ed803a25415800e1e9764f5d1c614c218f049c3e6980477b1cebf15979f0a',
	'3e123de107a60ef11dca8a5814ebfb18bb05a16013fdba6cd3d10a89d8055d9d',
	'cb99d5330ae43b20b8ed3a60c019a5f32c1b3741d3a1fb9b6dbadb5214abaa28',
	'c926f4c138a0a73f1b7f792acc4e6db57a421f4def781ed0248e6b43ee0cd0f6',
	'b1ffc3c38c49dbc62260b86b584f935ad798fe44142ce03348c0dbcaabd74f64',
	'9ef8d648c29f4679169dd7242aeeb4854f6ed944132602f29fa3cdd726dda529',
	'44a3145261d4ce106796b3af1226034c50f13df2adc6a93472f1a91c203a35ff',
	'bfe84b65172b69305d8a59fbcb1e701529ceea3ff59d14344a9b5e1693ec23c4',
	'499656e67617aa6f726ab17a1f0c365ad1e08922678c19335cf643fac66175f1',
	'2b613d2fa77f1d01bf25f00c5b082f3ca1799f4671bf67cfe08034afacde4a6a',
	'fdf3db4cd192f46b67b2b1a3d0acc27735455533998a6df8efae48df5fa580f7',
	'9fa5de875e225a20a9389facb18b4ac64e1e44c77445717cb98813469d54bfee',
	'57fb935d76f1ad411ffb73ed5089591c795e5b5be223381e1e5f2553bdc43fe8',
	'9235b768c6673ab5fba2372a3f03e706a50b72fb37f323dd59bb16e6edf2b56e',
	'3cad55836ee747bf983e9631c4111d30b9f0474aeb0917df5bcf397889886ae3',
	'67b4bd9ced909a2b112997683da3ddb503a8460b565b643ac95112e9a0e270d9',
	'c4517f104f5ee8d106753693a17e5e844c03bdd99a7bf3e69c01732c49bf51b2',
	'ce9b9fb2a623cf6153147173ad2b07860f9e11cef45f0e28612b8cc646862e03',
	'f49310efc84101f9bc16984b14b7e20cdb12966a8b7e18e13c86ebc07b2445ca',
	'467a8deffd5a7bbd53d23548720e9340298cd8ceacd00ce93b2a75cbd6c7d00f',
	'009c42b9840db4dd100727365be4f0a9f42bbba8dc884347cefae97e77368e07',
	'01dc7603a6edb80742f22a79aecdb281f60985663c9f113fe80f2692d2b37c13',
	'120fbd7d64215d5e2d08b6e9470e4d60f59b0eed672bd5e3a893c67a1fb54123',
	'9b4a865ca57d59cc46203cec5d794f48560b5c024aff76fdb0afa28ee6c092f5',
	'b1e0a2a5bcf1d83e3e641e14e91b555c6693a34d3a056b78e0ff6b7699d030c7',
	'8081ce61051714a39650bc87fe750da89707edc406fd14301d8eab80859e8ed8',
	'68fb98bd1bd43765df9f731c1499a3e4fc977164d8eb6b3332e4dd3b8136a99f',
	'cb3e780de810e0f3449b63e257c5fe7ccdc441e0e28f72f616482f4b4216c426',
	'10ec1154b5de4b039dcdb5848d084103d6150b004f58f45a524f1b1c543a2091',
	'a6680d7fd726cfd6bf41cbab05b9549f2616bfbe520c5d7f03d705e7d206c8d6',
	'9927574c52d82b7992ecbce739813f1fb50b0ed5d652cf2248154730a0b718b4',
	'f3d1fd3770f35fa78ba7cdf702ab30c7dcdf1a0afce34b994c5509b2c4e7c8eb',
	'd800cf402940c9aa5166bc0779a5b33a25240b5b6322ea3693faa6395dc8eb6a',
	'9221e4e2b3a75477ec6bb3f84c7e81ec7844c11514f2657c9522e5d7d97e1616',
	'2c39d611476b8f2ecdd79254c0918ca1b2c257d8423b722ba372c780b5d7b304',
	'1e486d8c6b5edcb5a175d923cf0d929183e2e964568c1d25f7d8f21b1c0bff1d',
	'651e5d878d8605fc23b2aa1bc1ee4e22768fe54ce9ef0fb693dabed3a8bca209',
	'ccd8bd6fdac3f18504655f89aff91fa5713462b1f8a4fd65f094949f814d7d51',
	'38176eb77855473c3c90d38a3d10f2ecfcc28955cb791e78ad010219868b664b',
	'662f591bec01cdccfdb705e3f3e487724dc81a5b8b727da5068da8053720fbcf',
	'1344771d0f6ea72924fb47f5a95164cf72687b91c83928f66d94d3067ff9e95e',
	'2a534c212acf02f12e96d6543813862b06ab7ec984ee5c2c5f7b2e278c9d11aa',
	'0d69c240e3acf171626bc5b2b1d18876327adaf471df8e8fcd627db7663e1c7b',
	'e0a3d9abf0e1dd13f8deb5c9ee8ed25ad7d947462c2c652da95ec20b88093e2b',
	'c518509bb86db19011c3376f8cc9b50e160ce868976dc008287fd49c0f1cdeba',
	'dbfeed82db40448c24d77efce886c86d776916eaf4967f02bfc66d3935aec34a',
	'af154a5421e6733c8d4f1447369da51ac8a5692abf15442da3bff27de5fdc98b',
	'0ac6d5a1a4bf82827ff15b557f052bd0b1e867e697554eec2f7c4f9ee626e1ea',
	'3b160ce6bf2bd1356974556ab12275d7a9f224f499c4aa9da92445c1526e7993',
	'a931864f191aaf14991d5cd86560e883e4d666d9157e0d2ccfcefd7875822c3d',
	'd77b99ef254bbd4553b4cf053f1d44495000caf8300fa67191b86e6d45e523ec',
	'3504b9f5f8a528156397e0829e291265acb2290fc4eecaa00a4548ce2dfce102',
	'54eb2a8624b7d933f94feccf7f9e9979ccf57ac7f6d1426629527514e56b5013',
	'94f22fc07abe7f2efa60c836f0e47f87ad571a66eba7ae6c510fb0dfda4efc42',
	'943f743874dffd9b1ddf2e146da20d7e80d625648156a768635fd54353aecbe4',
	'b75deb3d975606a12d609ba611058fa66f043ecb04e1dfa73cccba69a04a83f9',
	'd08b67b588de42438d6b6bb3eb99263e28fb7e613b796edba64471bcf56dfb4b',
	'747224297070bd757a0b32d2e4748eba4cc226537c295b2e31dec4468694c7c9',
	'729ea35ffd9d67ba4f1666dc32483de024d849dcec132e384922186a2d3fec89',
	'f1d9b550ffe1e92d1ecc00f473c35e7530b28b9a201b09dbe623a2cfe214bf81',
	'f2d7e74d6263cb9189da24fb552e9efcc31d1ec34a0d7c0c0cd94e00c9c12dfd',
	'8e19b68e8082526c0623bed3cbd05c2f79fde3d27e87119cc13a7aa4362330ca',
	'951c976863542dba58f522f3850e0dc0ec40cc7e2aaed0ce87e1dd0854fd51f3',
	'51af9bc9fa59a174c45d0d31cf29d0d38058bfc4d0eca3bfcc4d5749971e48e1',
	'4fd1ff17eba355c4ba67235cddd446913b69b0239e6567a4a9fd181bc50f200e',
	'18d5b963c698708c05fcc720a2015ef58ccceb9803ad609554db8aa6647dfa02',
	'bcf82dcc4c287e0361ac34db62571a889f8d463f33098eb11bb30c491379b40f',
	'fdbcdb8d89328101d5fcba3243f9658ce87267f8fd66f8b32867e7f1aefecb56',
	'1157b9b12668e9c41da71adfc22fd87ab7e7a12b5d56252556a9b0bca0c9fe4b',
	'41d43eff1a72c9e33d2745501e9a27fb63b47b921a9cacb5b9becd0d3d12871f',
	'363f290bd87b944e98989e1d27bd51bf984b40f07cdb42548aa938226c5ccc58',
	'64e624a48259dc54cd975f4d4601bc0474497b559868133a8bdf1f480b02c2c5',
	'f1d76a7e979ae4f87b00a1d06f71bbb25818242eee740d30992ca25c0ab7727e',
	'69e85150cd26fd87c0a1d34ee273ba855769aadc47318f0d957998a3d005450f',
	'bd5faecb2989776f8232619f614b17c83b96d63a7ca7355044c7666d0115bbbd',
	'9be2a1f47d0f96f8321d99ccec8bdfc1234099c51be78ad4515affc5b63179b3',
	'a2ad3919d8b3e63fed4cd35a786b9750e81b9cf77bceec57345899f40c560ace',
	'4a3cb21526d5941c4ce9e1716d0251d7a7d20ebbeda902b2078e8afecc9daff5',
	'4dbc3f2c505b094dd61cceb6114e4ed56a7d9f2d423ac0394cf1a983945550c9',
	'b976a2a718a03faeb21b29860fab4f30363ec71c0f617a9d9ae969b2788b7414',
	'8511b2db046b150c8a76946e5f91fce6b35d98652734d03413cefc8f73f8b3e9',
	'e92dffdeb9bd6531fb94ca51d1fa9ec1311bba6bb6ab448bbada5f620db61541',
	'c73c2f01b32dfcb0e88b39ce0e0c85031ca797b8f17aa77afd6b068f59dff1d7',
	'6a1fa0818bccdb4ffec170016050a375dd63269016d2b194f0d36306e6747981',
	'5102180479e2b48cfda09e882771c118d7bafe14fd1c647e894d9b8e198aed46',
	'2d164a5e1aaa24e742a3feb4971c109d40688714b415c224c514781b64d93d4f',
	'd500618decc9c86c9f14273515bcde2350fa9826f39a29bcab167ec846acd2f2',
	'4d2c390c55ab17441b1c6f4dd7b58556959c906f9537a3973b9002d87d57b39f',
	'9c745e1d750b2e64e8621e63706de013decba6de0dba49c797aa673f598dd5b7',
	'53b5d908e1b2ff6b612a44470d17db54ad29f0ffed9829d819c3b7e163249bfc',
	'eaebbc1f39d48379618eb017ebcf6a5d5103c297a9f310a05273e5ef5d0a49e1',
	'6487a2d7524b152cfe64920aa00e10413f3927b588ead2c7ad0e83d426ffc169',
	'bbed7c683b323dfe63b5b8051ffcf53753fefabf801c60002e6994aba9d27826',
	'739490faa2af5430e8cbc91b7adc92d39d4a9cdff32a5f52984fe2fa1817031d'
]

def check(fnames):
	filenames = []
	for fname in fnames:
		hash_algorithm = hashlib.sha256()
		with open(fname, "rb") as f:
			for chunk in iter(lambda: f.read(4096), b""):
				hash_algorithm.update(chunk)
		if hash_algorithm.hexdigest() not in hash_sums:
			filenames.append(fname)
	return {'nbForbiddenFiles': len(fnames) - len(filenames), 'filenames': filenames}
